<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Conditional channel capacity</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { color: #800000; } /* DataType */
code > span.dv { color: #0000ff; } /* DecVal */
code > span.bn { color: #0000ff; } /* BaseN */
code > span.fl { color: #800080; } /* Float */
code > span.ch { color: #ff00ff; } /* Char */
code > span.st { color: #dd0000; } /* String */
code > span.co { color: #808080; font-style: italic; } /* Comment */
code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
code > span.fu { color: #000080; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #ff00ff; } /* SpecialChar */
code > span.vs { color: #dd0000; } /* VerbatimString */
code > span.ss { color: #dd0000; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #808080; font-style: italic; } /* Documentation */
code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LogRegCapacity</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="examples.html">Basic Examples</a>
</li>
<li>
  <a href="testing.html">Testing procedures</a>
</li>
<li>
  <a href="conditional.html">Conditional channel capacity</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extensions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="formula.html">Formula of logistic regression model</a>
    </li>
    <li>
      <a href="klogistic.html">Kernel logistic regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Additional parameters
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="addpar_1.html">Main wrapper function</a>
    </li>
    <li>
      <a href="addpar_2.html">Parameters of nnet package</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Conditional channel capacity</h1>

</div>


<div id="estimating-conditional-channel-capacity" class="section level2">
<h2>Estimating conditional channel capacity</h2>
<p>Mutual information is an excellent tool to quantify cause-effect interactions, as long as the observed heterogeneity is solely the result of random fluctuations and as such consitutes the natural environemnt of the phenomenon in question. Nonetheless, the variability of the measured behaviour could also be a consequence of our inability to discover some other important factors. Then, the data is not representative of the underlying probability distributions leading to underestimation of the true statistical depdendence and information capacity. Therefore, a proper identification of subpopulations in the data, can lead to a more grounded capacity estimate.</p>
<p>We incorporate these concepts with our inofrmation theoretic framework. Formally, we hypothesize that some of the variability of the response can be a result of an unobserved covariate that indirectly influence the response. If this is the case, not accounting for this covariate generates artificial heterogeneity and, if information transmission is concerned, underestimate the true capacity of such channel. We thus assume that a channel <span class="math inline">\(\displaystyle X \xrightarrow{P(y|x)} Y\)</span> is additionally dependent on a side variable, <span class="math inline">\(S\)</span>, categorical or continuous that can interact with response, <span class="math inline">\(Y\)</span>. Practically, in the case of systems biology, <span class="math inline">\(S\)</span> represents the phase of cell cycle, the initial abundance of an important kinase, cell’s morphology or microenviornment of the population. In result, the channel is described by a relation <span class="math inline">\(Y\sim P(y|x;s)\)</span>.</p>
<p>Then, from basic probabilistic law <span class="math inline">\(P(y|x)=\int P(y|x,s)P(s)ds.\)</span> In addition, input <span class="math inline">\(X\)</span> is usually applied irrespective of the state, in which cells are, thus we can assume that <span class="math inline">\(X\)</span> and <span class="math inline">\(S\)</span> are independent: <span class="math inline">\(P(x,s)=P(x)P(s).\)</span></p>
<p>In this setting, the notion of mutual information can be extended by the use of conditional mutual information (CMI): <span class="math inline">\(\text{CMI}(X,Y|S)=H(X|S)-H(X|Y,S)\)</span>. Based on that we introduce conditional channel capacity (<span class="math inline">\(C^*_{cond}\)</span>) <span class="math display">\[
C^*_{cond}=\max_{P(X)} \text{ CMI}(X,Y|S) %= \max_{P(X)} \int P(s)\left( H(X|S=s)-H(X|Y,S=s) \right) ds.
\]</span></p>
<p>In many applications, CMI has proven to be an excellent measure to analyze interactions [ince2017statistical], couplings of time serie [frenzel2007partial] or network topology [zhang2011inferring,brunel2010miss]. From practical point of view, the assumption of independence between <span class="math inline">\(X\)</span> and <span class="math inline">\(S\)</span>, allows to rewrite this formula as <span class="math display">\[
C^*_{cond}=\max_{P(X)} \int \sum_{j=1}^m P(y,s|x_j)p(x_j)\log\frac{p(x_j|y,s)}{p(x_j)}dyds,
\]</span> and as such can be directly incorporated into our algorithm. The only change would be to estimate classifier with respect not only to output <span class="math inline">\(Y\)</span>, but also all possible interactions between <span class="math inline">\(Y\)</span> and <span class="math inline">\(S\)</span>.</p>
<p>The use of capacity <span class="math inline">\(C^*_{cond}\)</span> primarily gives a more realistic estimate of information that can be processed by a channel by explaining a portion of observed heterogeneity of the output. However, it can be also used to confirm, which features (side variables) manifest meaningful subpopulations by a formal statistical test.</p>
<p>To present a quantitative example of the use of <span class="math inline">\(C^*_{cond}\)</span>, consider a population, in which cells can be in three states, represented by side variable <span class="math inline">\(S\in\{s_1,s_2,s_3\}\)</span>, which occur with probabilities 0.6, 0.3 and 0.1, respectively. Cells are stimulated by four concentration of input, <span class="math inline">\(X\in\{x_1,x_2,x_3,x_4\}\)</span>. Let’s assume that the response of cell follows normal distribution given by a formula <span class="math display">\[ 
Y|X=x_j,S=s_g \quad \sim \quad \mathcal{N} (j\cdot g, 1^2).
\]</span> It can be interpreted that cells in state <span class="math inline">\(s_1\)</span> are rather insensitive to changes in input, whereas states <span class="math inline">\(s_2, s_3\)</span> corresponds to a responsive behaviour. The resulting distributions are depicted in below Figure.</p>
<div class="figure" style="text-align: center">
<img src="conditional_files/figure-html/unnamed-chunk-3-1.png" alt="Graphs of density plots of Y|X distributions" width="576" />
<p class="caption">
Graphs of density plots of Y|X distributions
</p>
</div>
<p>We sampled data from the distribution above, so that there are 1000 observations for each signal level by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">signal=<span class="kw">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;0.1&quot;</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;10&quot;</span>)
means=<span class="kw">list</span>()
sds=<span class="kw">list</span>()
means[[<span class="st">&quot;0&quot;</span>]]=<span class="st">   </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>  ,  <span class="dv">3</span> )
means[[<span class="st">&quot;0.1&quot;</span>]]=<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>  ,  <span class="dv">6</span> )
means[[<span class="st">&quot;1&quot;</span>]]=<span class="st">   </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">6</span>  , <span class="dv">9</span>   )
means[[<span class="st">&quot;10&quot;</span>]]=<span class="st">  </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>  , <span class="dv">12</span>   )
sds[[<span class="st">&quot;0&quot;</span>]]   =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>   , <span class="dv">1</span> ,<span class="dv">1</span>)
sds[[<span class="st">&quot;0.1&quot;</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> , <span class="dv">1</span>   ,<span class="dv">1</span>  )
sds[[<span class="st">&quot;1&quot;</span>]]   =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> ,<span class="dv">1</span> ,<span class="dv">1</span>)
sds[[<span class="st">&quot;10&quot;</span>]]  =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> , <span class="dv">1</span> ,<span class="dv">1</span>  )
N=<span class="kw">c</span>(<span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">1000</span>)
<span class="kw">names</span>(N)&lt;-signal
sideTypes=<span class="kw">c</span>(<span class="st">&quot;type 1&quot;</span>,<span class="st">&quot;type 2&quot;</span>,<span class="st">&quot;type 3&quot;</span>)
probs=<span class="kw">c</span>(<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>)
data=<span class="kw">do.call</span>(rbind,<span class="kw">lapply</span>(signal,function(x){
  components&lt;-<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">3</span>,<span class="dt">prob=</span>probs,<span class="dt">size=</span>N[x],<span class="dt">replace=</span><span class="ot">TRUE</span>)
  sideVarSample &lt;-<span class="st"> </span>sideTypes[components]
  ResponseSample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span>N[x],<span class="dt">mean=</span>means[[x]][components],<span class="dt">sd=</span>sds[[x]][components])
  <span class="kw">data.frame</span>(<span class="dt">sideVar=</span>sideVarSample,<span class="dt">response=</span>ResponseSample,<span class="dt">signal=</span>x)
}))
<span class="kw">colnames</span>(data)&lt;-<span class="kw">c</span>(<span class="st">&quot;sideVar&quot;</span>,<span class="st">&quot;response&quot;</span>,<span class="st">&quot;signal&quot;</span>)</code></pre></div>
<p>Now, in order to calculate conditional channel capacity within our package it is enough to specify <code>side_variable</code> and a proper <code>formula_string</code> as an argument to <code>capacity_logreg_main</code>, e.g.</p>
<p><code>capacity_logreg_main(dataRaw=data, signal=&quot;signal&quot;, response=&quot;response&quot;, side_variables = &quot;sideVar&quot; , formula_string = &quot;signal~response*sideVar&quot;)</code></p>
<p>If the knowledge about cellular state is not taken into account, differences of response between subsequent inputs for cellular states <span class="math inline">\(s_2\)</span> and <span class="math inline">\(s_3\)</span> are blurred by observed output of cells in state <span class="math inline">\(s_1\)</span>, especially if this is the most prevalent case. Precisely, variances of distributions <span class="math inline">\(Y|X=x_j\)</span> are several times higher. This is visible in low capacity of such system achieving only 0.65 bit. On the other hand, incorporating the variable <span class="math inline">\(S\)</span> into the analysis by calculating <span class="math inline">\(C^*_{cond}\)</span> can correct for this phenomenon and give a significantly higher estimate of capacity of 0.95 bit. Capacities calculated based on observations restricted only to a single subpopulation corraborate the sensitivness of cells in states <span class="math inline">\(s_2\)</span> and <span class="math inline">\(s_3\)</span> since they achieve significantly higher capacities .</p>
<div class="figure" style="text-align: center">
<img src="conditional_files/figure-html/unnamed-chunk-5-1.png" alt="Capacities of example using different setups in comparison to conditional channel capacity." width="960" />
<p class="caption">
Capacities of example using different setups in comparison to conditional channel capacity.
</p>
</div>
</div>

<p>See package on <a href="https://github.com/TJetka/LogRegCapacity">GitHub</a>. In case of any problems, please contact the authors for further instructions: t.jetka at gmail.com.</p>
<p>Copyright &copy; 2018 Tomasz Jetka.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
